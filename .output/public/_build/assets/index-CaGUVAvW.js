import{i as T,d as l,a as j,b as g,c as O,e as F,u as R,R as b,j as E}from"./client-B-FcvFRS.js";function $(e){return e instanceof Headers?new Headers(e):Array.isArray(e)?new Headers(e):typeof e=="object"?new Headers(e):new Headers}function S(...e){return e.reduce((n,t)=>{const r=$(t);for(const[a,o]of r.entries())n.set(a,o);return n},new Headers)}const H=[];function h(e,n){const t=n||e||{};return typeof t.method>"u"&&(t.method="GET"),{options:t,middleware:r=>h(void 0,Object.assign(t,{middleware:r})),validator:r=>h(void 0,Object.assign(t,{validator:r})),handler:(...r)=>{const[a,o]=r;Object.assign(t,{...a,extractedFn:a,serverFn:o}),T(a.url);const i=[...t.middleware||[],A(t)];return Object.assign(async c=>v(i,"client",{...a,method:t.method,data:c?.data,headers:c?.headers,context:{}}).then(s=>{if(s.error)throw s.error;return s.result}),{...a,__executeServer:async c=>{const s=c instanceof FormData?C(c):c;return await v(i,"server",{...a,...s}).then(d=>({result:d.result,error:d.error,context:d.sendContext}))}})}}}function C(e){const n=e.get("__TSR_CONTEXT");if(e.delete("__TSR_CONTEXT"),typeof n!="string")return{context:{},data:e};try{return{context:l.parse(n),data:e}}catch{return{data:e}}}function M(e){const n=new Set,t=[],r=a=>{a.forEach(o=>{o.options.middleware&&r(o.options.middleware),n.has(o)||(n.add(o),t.push(o))})};return r(e),t}const y=async(e,n,t)=>e({...n,next:async(r={})=>t({...n,...r,context:{...n.context,...r.context},sendContext:{...n.sendContext,...r.sendContext??{}},headers:S(n.headers,r.headers),result:r.result!==void 0?r.result:n.result,error:r.error??n.error})});function N(e,n){if(e==null)return{};if("~standard"in e){const t=e["~standard"].validate(n);if(t instanceof Promise)throw new Error("Async validation not supported");if(t.issues)throw new Error(JSON.stringify(t.issues,void 0,2));return t.value}if("parse"in e)return e.parse(n);if(typeof e=="function")return e(n);throw new Error("Invalid validator type!")}async function v(e,n,t){const r=M([...H,...e]),a=async o=>{const i=r.shift();if(!i)return o;i.options.validator&&(n!=="client"||i.options.validateClient)&&(o.data=await N(i.options.validator,o.data));const c=n==="client"?i.options.client:i.options.server;return c?y(c,o,async s=>{const f=i.options.clientAfter;if(n==="client"&&f){const d=await a(s);return y(f,{...s,...d},p=>p)}return a(s).catch(d=>{if(j(d)||g(d))return{...s,error:d};throw d})}):a(o)};return a({...t,headers:t.headers||{},sendContext:t.sendContext||{},context:t.context||{}})}function A(e){return{_types:void 0,options:{validator:e.validator,validateClient:e.validateClient,client:async({next:n,sendContext:t,...r})=>{var a;const o=await((a=e.extractedFn)==null?void 0:a.call(e,{...r,context:t}));return n(o)},server:async({next:n,...t})=>{var r;const a=await((r=e.serverFn)==null?void 0:r.call(e,t));return n({...t,result:a})}}}}async function I(e,n,t){var r;const a=n[0];if(O(a)&&a.method){const s=a,f=s.data instanceof FormData?"formData":"payload",d=new Headers({...f==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...s.headers instanceof Headers?Object.fromEntries(s.headers.entries()):s.headers||{}});if(s.method==="GET"){const u=F({payload:l.stringify({data:s.data,context:s.context})});u&&(e+=`&${u}`)}const p=new Request(e,{method:s.method,headers:d,...P(s)}),_=await t(p),w=await m(_);if((r=w.headers.get("content-type"))!=null&&r.includes("application/json")){const u=l.decode(await w.json());if(j(u)||g(u)||u instanceof Error)throw u;return u}return w}const o=new Request(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}),i=await m(await t(o)),c=i.headers.get("content-type");return c&&c.includes("application/json")?l.decode(await i.json()):i.text()}function P(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",l.stringify(e.context)),{body:e.data}):{body:l.stringify({data:e.data??null,context:e.context})}:{}}async function m(e){if(!e.ok){const n=e.headers.get("content-type");throw n&&n.includes("application/json")?l.decode(await e.json()):new Error(await e.text())}return e}function k(e){return e.replace(/^\/|\/$/g,"")}function q(e,n,t){return`${e}/${k("/_server")}/?_serverFnId=${encodeURI(n)}&_serverFnName=${encodeURI(t)}`}function x(e,n,t){const r=q(window.location.origin,n,t);return Object.assign((...o)=>I(r,o,fetch),{url:r,filename:n,functionId:t})}const z=h({method:"GET"}).handler(x(B,"c_gpfkzj","$$function0")),J=h({method:"POST"}).handler(x(G,"c_gpfkzj","$$function1")),X=function(){const n=R(),t=b.useLoaderData();return E.jsxs("button",{className:"btn",type:"button",onClick:()=>{J({data:1}).then(()=>{n.invalidate()})},children:["Add 1 to ",t,"?"]})},D=async()=>await z();function B(e){}function G(e){}export{B as $$function0,G as $$function1,X as component,D as loader};
